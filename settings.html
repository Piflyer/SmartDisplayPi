<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">
  <link href='style.css' rel='stylesheet' />
  <title>Settings</title>
  <script src="https://unpkg.com/hotkeys-js/dist/hotkeys.min.js"></script>
  <script type="text/javascript">
    hotkeys('ctrl+shift+d', function (event, handler) {
      event.preventDefault();
      window.location.href = "devmode.html";
    });
  </script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

</head>

<body>
  <a id="bar2" href="http://localhost:8123/config/dashboard"></a>
  <a href="http://localhost:8123/config/dashboard"><img id="halogoset" src="halogo.png"></a>
  <div id="hatext">Home Assistant</div>
  <div id="hadescr">Control and manage Home Assistant</div>
  <a id="bar3" href="http://localhost:8081/index.php?page=wpa_conf"></a>
  <a href="http://localhost:8081/index.php?page=wpa_conf"><img id="raspaplogoset" src="raspAP-logo.png"></a>
  <div id="raspaptext">RasAP</div>
  <div id="raspapdescr">Control and manage network settings via RaspAP</div>
  <a id="bar4" href="Setup/wizardhome.html"></a>
  <a id="setupcircle" href="Setup/wizardhome.html"></a>
  <div id="chrometext">Setup Wizard</div>
  <div id="chromedescr">Launch Setup Wizard</div>

  <div id="bar1"></div>
  <div class="animate__animated animate__slideInUp" id="shortcuts">
    <a href="http://localhost:8123" id="first-image"><img src="media/halogo.png"></a>
    <a href="https://www.youtube.com/tv"><img src="media/youtube.png"></a>
    <a href="ambient.html"><img src="media/gclock.png"></a>
    <a href="https://www.tasty.co"><img src="media/tastylogo.jpeg"></a>
    <a href="http://127.0.0.1:8080/"><img src="media/googlephotos.png"></a>
    <a href="settings.html"><img src="media/settings.png"></a>
  </div>
  <div id="homebutton" onclick="closeopen()">
    <div id="homesquare"></div>
  </div>
  <script>
    var fs = require("fs");
    read_file = function (path) {
      return fs.readFileSync(path, 'utf8');
    }

    write_file = function (path, output) {
      fs.writeFileSync(path, output);
    }
    settings = JSON.parse(read_file("/home/pi/SmartDisplayPi/settings.json"));
    if (settings.devmode == true) {
      document.getElementById("exitdev").style.display = "block";
    }
    document.getElementById("exitdev").onclick = function () {
      q = confirm("Are you sure you want to exit developer mode?");
      if (q) {
        settings.devmode = false;
        write_file("/home/pi/SmartDisplayPi/settings.json", JSON.stringify(settings));
        console.log("Rebooting")
        var exec = require('child_process').exec;

        // Create shutdown function
        function shutdown(callback) {
          exec('shutdown -r now', function (error, stdout, stderr) { callback(stdout); });
        }

        // Reboot computer
        shutdown(function (output) {
          console.log(output);
        });
      }
    }
  </script>
  <script src="universal.js"></script>

</body>

</html>